"use client";

import gsap from "gsap";
import { MorphSVGPlugin } from "gsap/MorphSVGPlugin";
import { useRef, useLayoutEffect } from "react";

// Register MorphSVGPlugin
gsap.registerPlugin(MorphSVGPlugin);

export default function LogoMorph() {
  const circleRef = useRef<SVGPathElement | null>(null);
  const logoRef = useRef<SVGPathElement | null>(null);

  useLayoutEffect(() => {
    const ctx = gsap.context(() => {
      if (circleRef.current && logoRef.current) {
        gsap.to(circleRef.current, {
          duration: 2,
          repeat: -1,
          yoyo: true,
          ease: "power1.inOut",
          morphSVG: {
            shape: logoRef.current,
          },
        });
      }
    });

    return () => ctx.revert();
  }, []);

  return (
    <svg
      width="200"
      height="200"
      viewBox="0 0 500 500"
      xmlns="http://www.w3.org/2000/svg"
    >
      {/* Circle Shape */}
      <path
        ref={circleRef}
        fill="#ffffff"
        d="M250,250c0,-100 200,-100 200,0s-200,100 -200,0z"
      />

      {/* Complex Logo Path (hidden initially, used only for morph target) */}
      <path
        ref={logoRef}
        fill="#ffffff"
        style={{ visibility: "hidden" }}
        d="M2120 515 c-13 -7 -30 -28 -39 -46 -15 -31 -20 -34 -63 -34 -31 -1 -54 -7 -67 -19 -19 -18 -21 -18 -64 3 -51 25 -85 26 -134 6 -37 -16 -55 -10 -76 23 -4 6 -21 19 -37 27 -36 19 -72 7 -96 -30 -14 -22 -22 -25 -43 -20 -14 4 -62 8 -106 9 -74 1 -80 3 -92 26 -16 33 -50 60 -75 60 -10 0 -30 -12 -43 -26 -24 -26 -25 -32 -25 -175 0 -186 1 -187 126 -187 77 0 86 2 103 24 11 14 17 33 14 44 -7 28 6 92 18 85 5 -4 9 -31 9 -61 0 -41 5 -59 20 -74 24 -24 67 -26 91 -4 17 15 20 15 43 0 29 -18 78 -21 107 -6 13 8 34 6 73 -5 57 -17 92 -13 138 13 25 14 29 14 46 -1 31 -28 77 -22 106 16 14 17 26 26 26 20 0 -22 39 -53 67 -53 14 0 35 7 45 17 17 15 21 15 57 -2 53 -23 108 -24 158 -1 38 17 43 17 64 2 34 -23 72 -20 99 9 l24 25 22 -21 c30 -28 90 -41 136 -28 72 19 111 102 73 156 -12 17 -13 27 -3 47 25 57 -40 114 -116 101 -48 -8 -61 -8 -145 -3 -52 3 -68 0 -88 -16 -24 -18 -27 -18 -52 -3 -49 29 -103 31 -156 8 -26 -12 -49 -21 -52 -21 -2 0 -1 15 2 33 11 59 -46 108 -95 82z m59 -39 c9 -11 10 -20 1 -36 -21 -39 -83 -7 -67 34 8 20 50 21 66 2z m-914 -156 l0 -160 -32 0 -33 0 0 160 0 160 33 0 32 0 0 -160z m375 105 c0 -20 5 -25 25 -25 21 0 25 -5 25 -31 0 -28 -2 -31 -25 -25 -25 6 -25 6 -25 -59 0 -58 2 -65 20 -65 16 0 20 -7 20 -30 0 -26 -3 -30 -29 -30 -53 0 -70 26 -73 110 -2 59 -6 75 -18 75 -9 0 -16 11 -18 28 -3 22 1 27 18 27 19 0 21 4 16 25 -6 23 -4 25 29 25 31 0 35 -3 35 -25z m-276 -40 c-4 -8 -3 -15 1 -15 3 0 13 7 21 15 9 8 33 15 54 15 30 0 43 -6 64 -31 24 -28 26 -38 26 -120 l0 -89 -32 0 -33 0 3 73 c3 61 0 77 -16 97 -17 21 -24 23 -48 15 -29 -10 -29 -12 -32 -98 l-3 -87 -34 0 -35 0 0 120 0 120 35 0 c26 0 33 -3 29 -15z m521 -7 c27 -21 55 -73 55 -103 0 -12 -16 -15 -90 -15 -86 0 -104 -6 -77 -27 24 -19 45 -21 73 -7 23 12 33 13 51 3 31 -17 29 -26 -9 -49 -51 -31 -110 -27 -152 11 -61 53 -58 130 6 184 39 33 104 34 143 3z m135 0 l0 -22 20 22 c31 33 60 29 60 -7 0 -24 -5 -30 -30 -35 -40 -7 -54 -44 -46 -118 l6 -58 -35 0 -35 0 0 120 0 120 30 0 c24 0 30 -4 30 -22z m160 -98 l0 -120 -36 0 c-29 0 -35 3 -30 16 3 9 6 63 6 120 l0 104 30 0 30 0 0 -120z m238 86 c34 -31 37 -39 37 -86 0 -47 -3 -55 -37 -86 -30 -27 -46 -34 -78 -34 -48 0 -92 20 -114 52 -18 26 -21 100 -5 129 17 32 70 59 117 59 34 0 49 -6 80 -34z m126 12 l-6 -23 24 23 c35 32 58 29 58 -8 0 -21 -5 -30 -17 -30 -38 0 -53 -30 -53 -107 l0 -73 -32 0 -33 0 0 120 0 120 33 0 c30 0 33 -2 26 -22z m244 4 l23 -18 -21 -19 c-17 -16 -23 -17 -44 -5 -27 14 -60 7 -54 -12 3 -7 20 -16 39 -21 74 -19 100 -77 54 -122 -29 -30 -89 -34 -135 -10 -35 18 -37 26 -12 48 15 13 19 14 36 1 23 -16 62 -19 71 -4 10 16 -12 37 -47 44 -66 13 -86 60 -47 110 17 21 28 26 67 26 29 0 56 -7 70 -18z m-173 -127 c0 -10 -6 -20 -12 -22 -8 -3 -13 5 -13 22 0 17 5 25 13 23 6 -3 12 -13 12 -23z"
      />
    </svg>
  );
}
